(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["items"],{2909:function(t,e,a){"use strict";var n=a("6b75");function s(t){if(Array.isArray(t))return Object(n["a"])(t)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0");function i(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var r=a("06c5");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t){return s(t)||i(t)||Object(r["a"])(t)||c()}a.d(e,"a",(function(){return o}))},"5f9e":function(t,e,a){},"65cc":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop-toolkit"},[a("go-back"),t.loading?a("div",[a("load-indicator",{attrs:{loadText:"正在加载商店列表"}})],1):t._e(),t.npcData?a("div",[a("div",{staticClass:"row-wrapper"},[t._m(0),a("div",t._l(t.npcData,(function(e,n){return a("button",{key:n,class:{"is-selected":t.selectedArea==n},on:{click:function(e){return t.clickButton("Area",n)}}},[t._v(t._s(e.name))])})),0)]),a("div",{staticClass:"row-wrapper"},[t._m(1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowNpc,expression:"isShowNpc"}]},t._l(t.npcData[t.selectedArea].data,(function(e,n){return a("button",{key:n,class:{"is-selected":t.selectedNpc==n},on:{click:function(e){return t.clickButton("Npc",n)}}},[t._v(t._s(e.name))])})),0)]),a("div",{staticClass:"row-wrapper"},[t._m(2),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowShop,expression:"isShowShop"}]},t._l(t.npcData[t.selectedArea].data[t.selectedNpc].data,(function(e,n){return a("button",{key:n,class:{"is-selected":t.selectedShop==n},on:{click:function(e){return t.clickButton("Shop",n)}}},[t._v(t._s(e.name))])})),0)]),"number"===typeof t.npcData[t.selectedArea].data[t.selectedNpc].data[t.selectedShop].data?a("div",{staticClass:"row-wrapper"}):a("div",{staticClass:"row-wrapper"},[t._m(3),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowJob,expression:"isShowJob"}]},t._l(["战士","弓箭","法师","牧师","学者","舞娘","刺客","萌骑士","兽娘","浪客"],(function(e,n){return a("button",{key:n,class:{"is-selected":t.selectedJob==n},on:{click:function(e){return t.clickButton("Job",n)}}},[t._v(t._s(e))])})),0)])]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowShop,expression:"isShowShop"}]},[a("button",{staticStyle:{"margin-top":"20px"},on:{click:t.search}},[t._v("查询")])]),a("div",{staticClass:"browser"},[t.shopId?a("shop-browser",{attrs:{shopId:t.shopId,useClick:t.isClick}}):t._e()],1)],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-font"},[a("span",[t._v("区域")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-font"},[a("span",[t._v("NPC")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-font"},[a("span",[t._v("商店")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title-font"},[a("span",[t._v("职业")])])}],i=a("2b0e"),r=a("c003"),c=a("27c7"),o=a("e3c0"),u=a("40a3"),l=a("a0c2");i["a"].component("load-indicator",u["a"]);var d=i["a"].extend({components:{ShopBrowser:r["a"],GoBack:o["a"]},data:function(){return{selectedArea:0,selectedNpc:0,selectedShop:0,selectedJob:0,isShowNpc:!0,isShowShop:!0,isShowJob:!0,npcData:null,shopId:0,isClick:!0,loading:!0}},created:function(){var t=this,e=this.$store.getters.shopIndex;e?(this.npcData=e,this.loading=!1):c["a"].get("shopIndex.php?lan=cn").then((function(e){t.npcData=e.data,t.$store.dispatch(l["a"].SetShopIndex,e.data),t.loading=!1})).catch((function(t){console.log("err: ",t)}))},methods:{search:function(){this.$set(this,"shopId",this.selectedId)},clickButton:function(t,e){"Area"===t&&(this.selectedArea=e,this.selectedNpc=0,this.selectedShop=0,this.selectedJob=0),"Npc"===t&&(this.selectedNpc=e,this.selectedShop=0,this.selectedJob=0),"Shop"===t&&(this.selectedShop=e,this.selectedJob=0),"Job"===t&&(this.selectedJob=e)}},computed:{selectedId:function(){var t=this.npcData[this.selectedArea].data[this.selectedNpc].data[this.selectedShop].data;return t?"number"===typeof t?t:t[this.selectedJob]:0}},watch:{}}),h=d,p=(a("cb54"),a("2877")),m=Object(p["a"])(h,n,s,!1,null,"13d95a39",null);e["default"]=m.exports},"9e50":function(t,e,a){"use strict";a("dd3b")},c003:function(t,e,a){"use strict";var n,s,i,r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item-shop"},[t.shopData.loading?a("div",{staticClass:"loading"},[a("loader",{attrs:{"load-text":"正在加载商店"}})],1):t._e(),t.shopData.value?a("div",{staticClass:"result"},[a("div",{staticClass:"shop-pane"},[a("div",{staticClass:"pages"},t._l(t.numPages,(function(e,n){return a("div",{key:e,staticClass:"page-tab",attrs:{active:n===t.pageNumber},on:{click:function(e){return t.setPage(n)}}},[t._v(" "+t._s(e)+" ")])})),0),a("div",{staticClass:"item-grid"},t._l(t.currentPageSlots,(function(e,n){return a("div",{key:n,staticClass:"grid-entry",class:-1!==t.highlight.findIndex((function(t){return n===t}))?"highlight":""},[e?[a("item-icon-tooltip",{attrs:{itemId:e.itemId,count:e.quantity,userData:e,noLink:!t.useClick,directionHint:n>9?"up":"down"},on:{click:t.clickItem}},[a("div",{staticClass:"purchase-details"},[e.seals>=0?a("div",{staticClass:"seals section"},[0==e.seals?[t._v(" Item can have bindings added ")]:[t._v(" Item has "),a("strong",[t._v(t._s(e.seals))]),t._v(" unbinds ")]],2):t._e(),a("div",{staticClass:"costs section"},[a("div",{staticClass:"cost-label"},[t._v("购买")]),t._l(e.cost,(function(e,n){return a("div",{key:n,staticClass:"cost"},[1==e.costType?a("div",{staticClass:"gold"},[e.costParam?[t._v(t._s(t._f("gold")(e.costParam)))]:t._e()],2):2==e.costType?a("div",{staticClass:"card-container"},[a("item-card",{attrs:{itemId:e.costItemId,count:e.costParam,noLink:!0,onClick:function(){}}})],1):3==e.costType?[a("strong",[t._v(t._s(e.costParam)+" 天梯点数")])]:4==e.costType?[a("strong",[t._v(t._s(e.costParam)+" 联盟点数")])]:a("div",{staticClass:"point-container"},[a("point-tag",{attrs:{pointId:e.costType,amount:e.costParam,noTip:!0}})],1)],2)}))],2),e.limitReset?a("div",{staticClass:"limits section"},[t._v(" 限制 "),a("strong",[t._v(t._s(t.limitString(e)))])]):t._e(),e.limitType?a("div",{staticClass:"requirements section"},[2==e.limitType?[t._v(" 需要 Lv "),a("strong",[t._v(t._s(e.limitParam)+"+")])]:3==e.limitType?[t._v(" 需要 PvP 等级 "),a("strong",[t._v(t._s(e.limitParam)+"+")])]:6==e.limitType?[a("strong",[t._v(t._s(e.limitParam)+"+")]),t._v(" 需要成就点数 ")]:7==e.limitType?[t._v(" 需要天梯等级 "),a("strong",[t._v(t._s(t._f("LadderRank")(e.limitParam))+"以上")])]:t._e()],2):t._e()])])]:t._e()],2)})),0)]),a("div",{staticClass:"tabs"},t._l(t.shopData.value.tabs,(function(e){return a("div",{key:e.id,staticClass:"tab",attrs:{active:t.tabIndex===e.id},on:{click:function(a){return t.setTab(e.id)}}},[t._v(" "+t._s(e.name.message)+" ")])})),0)]):t._e()])},c=[],o=(a("99af"),a("4de4"),a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("ddb0"),a("96cf"),a("1da1")),u=a("2909"),l=a("2b0e"),d=a("bfe8"),h=(a("13d5"),a("07ac"),a("3ca3"),a("b85c")),p=a("d4ec"),m=a("bee2"),_=a("ae36"),v=a("3a0b"),f=a("7e55"),b=a("6ebb"),I=function(){function t(){Object(p["a"])(this,t),this._shopCache={},this._shopReqCache=new _["a"]}return Object(m["a"])(t,[{key:"getShop",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,a){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=this._ensureRegion(a),n=this._cacheKey(e,a),s=this._shopCache[n],!s){t.next=5;break}return t.abrupt("return",Promise.resolve(s));case 5:return t.abrupt("return",this._shopReqCache.tryCache(n,Object(o["a"])(regeneratorRuntime.mark((function t(){var n,s,i,r,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b["a"].getTableRowsMatching("virt.combinedshoptable","_ShopID","eq",e,a,{limit:2e3});case 2:n=t.sent,s={id:e,tabs:[]},i=Object.values(n.reduce((function(t,e){return t[e._TabID]=e._TabID,t}),{})),r=regeneratorRuntime.mark((function t(){var e,i,r,u,l,d,p,m,_;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=o[c],i=n.find((function(t){return t._TabID===e})),!i){t.next=14;break}return r=i._TabNameID,t.t0=e,t.next=7,f["a"].get(r,a);case 7:t.t1=t.sent,t.t2=[],u={id:t.t0,name:t.t1,entries:t.t2},l=n.filter((function(t){return t._TabID===e})),d=Object(h["a"])(l);try{for(d.s();!(p=d.n()).done;)m=p.value,_={id:m.id,index:m._ListID,itemId:m._itemindex,quantity:m._Quantity,cost:[{costType:m._PurchaseType1,costItemId:m._PurchaseItem1,costParam:m._PurchaseItemValue1},{costType:m._PurchaseType2,costItemId:m._PurchaseItem2,costParam:m._PurchaseItemValue2}].filter((function(t){return t.costType})),limitType:m._PurchaseLimitType,limitParam:m._PurchaseLimitValue,limitCount:m._buyLimitCount,limitReset:m._ShopLimitReset,itemOption:m._ItemOptionID,RepurchaseTime:m._RepurchaseTime,seals:m._ShopSealCount,rollPotentialOnPurchase:m._PotentialList},u.entries.push(_)}catch(v){d.e(v)}finally{d.f()}s.tabs.push(u);case 14:case"end":return t.stop()}}),t)})),c=0,o=i;case 7:if(!(c<o.length)){t.next=12;break}return t.delegateYield(r(),"t0",9);case 9:c++,t.next=7;break;case 12:return t.abrupt("return",s);case 13:case"end":return t.stop()}}),t)})))));case 6:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()},{key:"_ensureRegion",value:function(t){return t||v["a"].state.regionCode}},{key:"_cacheKey",value:function(t,e){return"".concat(e,":").concat(t)}}]),t}(),C=new I,g=a("40a3");(function(t){t[t["NONE"]=0]="NONE",t[t["COIN"]=1]="COIN",t[t["ITEM"]=2]="ITEM",t[t["LADDER_POINTS"]=3]="LADDER_POINTS",t[t["FRIENDSHIP"]=4]="FRIENDSHIP",t[t["BEGIN_POINTS"]=8]="BEGIN_POINTS"})(n||(n={})),function(t){t[t["NONE"]=0]="NONE",t[t["MIN_LEVEL"]=2]="MIN_LEVEL",t[t["MIN_PVP_RANK"]=3]="MIN_PVP_RANK",t[t["ACHIEVEMENT_POINTS"]=6]="ACHIEVEMENT_POINTS",t[t["MIN_LADDER_RANK"]=7]="MIN_LADDER_RANK"}(s||(s={})),function(t){t[t["NONE"]=0]="NONE",t[t["DAILY"]=1]="DAILY",t[t["WEEKLY"]=2]="WEEKLY",t[t["DAILY_ACCOUNT"]=3]="DAILY_ACCOUNT",t[t["WEEKLY_ACCOUNT"]=4]="WEEKLY_ACCOUNT",t[t["WEEKLY_ACCOUNT_PER"]=5]="WEEKLY_ACCOUNT_PER"}(i||(i={}));var N=a("f62c"),w=a("7ea2"),T=a("343a");l["a"].component("point-tag",T["a"]);var y=l["a"].extend({props:{shopId:{type:Number},useClick:{type:Boolean,default:!1},highlight:{type:Array,default:function(){return[]}}},components:{Loader:g["a"],ItemIconTooltip:N["a"],ItemCard:w["a"]},data:function(){return{shopData:new d["a"],tabIndex:0,pageNumber:0}},watch:{shopId:function(){this.load()}},computed:{numPages:function(){if(this.shopData.value){var t=this.currentTab;if(t)return Math.max(1,Math.ceil(Math.max.apply(Math,Object(u["a"])(t.entries.map((function(t){return t.index}))))/30))}return 0},currentTab:function(){var t=this;return this.shopData.value&&this.shopData.value.tabs.find((function(e){return e.id===t.tabIndex}))||null},currentTabItems:function(){var t=this.currentTab;return t?t.entries:[]},currentPageItems:function(){var t=this;return this.currentTabItems.filter((function(e){return e.index>=30*t.pageNumber&&e.index<30*(t.pageNumber+1)}))},currentPageSlots:function(){for(var t=this,e=[],a=function(a){var n=30*t.pageNumber+a;e[a]=t.currentPageItems.find((function(t){return t.index===n}))||null},n=0;n<30;++n)a(n);return e}},mounted:function(){this.load()},methods:{load:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.shopData.loading){e.next=2;break}return e.abrupt("return");case 2:return t.shopData.startLoad(),e.prev=3,e.t0=t.shopData,e.next=7,C.getShop(t.shopId);case 7:e.t1=e.sent,e.t0.done.call(e.t0,e.t1),t.shopData.value&&t.shopData.value.tabs[0]&&(t.tabIndex=t.shopData.value.tabs[0].id),e.next=15;break;case 12:e.prev=12,e.t2=e["catch"](3),t.shopData.failed(e.t2);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})))()},setTab:function(t){this.tabIndex=t,this.pageNumber=0},setPage:function(t){this.pageNumber=t},limitString:function(t){if(t.RepurchaseTime>0)return this.formattingTime(t.RepurchaseTime)+"可以再次购买";switch(t.limitReset){case i.DAILY:return"每天可购买 ".concat(t.limitCount," 个");case i.DAILY_ACCOUNT:return"账号每天可购买 ".concat(t.limitCount," 个");case i.WEEKLY:return"每周可购买 ".concat(t.limitCount," 个");case i.WEEKLY_ACCOUNT:return"账号每周可购买 ".concat(t.limitCount," 个");case i.WEEKLY_ACCOUNT_PER:return"账号每周可购买 ".concat(t.limitCount," 个");default:return"".concat(t.limitCount," per unknown:").concat(t.limitReset)}},clickItem:function(t){this.$emit("click",t)},formattingTime:function(t){var e="",a=t%60,n=t/60%60;e=a+"秒",n>=1&&(e=n+"分"+a+"秒");var s=t/60/60%24;s>=1&&(e=s+"小时"+n+"分"+a+"秒");var i=t/60/60/24;return i>=1&&(e=i+"天"+s+"小时"+n+"分"+a+"秒"),e}}}),E=y,k=(a("9e50"),a("2877")),P=Object(k["a"])(E,r,c,!1,null,"20fe35eb",null);e["a"]=P.exports},cb54:function(t,e,a){"use strict";a("5f9e")},dd3b:function(t,e,a){}}]);
//# sourceMappingURL=items.208dd651.js.map